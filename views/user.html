<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>user</title>
  <link rel="stylesheet" href="/static/css/user.css">
</head>
<body>
<div class="container">
  <!-- Current User Panel -->
  <div class="current-user-panel">
    <h3>CURRENT USER</h3>
    <div class="photo-placeholder">
    </div>
    <div class="info">
      <p>username: <span>{{.Username}}</span></p>
      <p>login: <span>{{.Login}}</span></p>
      <p>email: <span>{{.WorkingEmail}}</span></p>
      <p>role: <span>{{.RolesID}}</span></p>
    </div>
  </div>

  <!-- центральная панель -->
  <div class="new-user-panel">
    <h3>NEW USER</h3>
    <form action="/user/add" method="POST">
      <label for="new-username">Username:</label>
      <input type="text" id="new-username" name="username" placeholder="Enter username" required>

      <label for="new-login">Login:</label>
      <input type="text" id="new-login" name="login" placeholder="Enter login" required>

      <label for="new-password">Password:</label>
      <input type="password" id="new-password" name="password" placeholder="Enter password" required>

      <label for="new-email">Email:</label>
      <input type="email" id="new-email" name="email" placeholder="Enter email" required>

      <label for="new-roles-id">Role ID:</label>
      <select id="new-roles-id" name="roles_id" required>
        <option value="1">Admin</option>
        <option value="2" selected>User</option>
      </select>

      <button type="submit">Submit</button>
    </form>
  </div>

  <!-- список пользователей -->
  <div class="user-list-panel">
    <h3>USER LIST</h3>
    <div class="user-list" id="userList">
      {{range .Users}}
      <div class="user-item">
        <p><strong>Username:</strong> {{.Username}}</p>
        <p><strong>Login:</strong> {{.Login}}</p>
        <p><strong>Email:</strong> {{.WorkingEmail}}</p>
        <p><strong>Role ID:</strong> {{.RolesID}}</p>
      </div>
      <hr>
      {{end}}
    </div>
  </div>
</div>

<script>
  async function fetchUsers() {
    try {
      const response = await fetch('/user/list');
      if (response.ok) {
        const users = await response.json();
        const userList = document.querySelector('.user-list');
        userList.innerHTML = "";

        users.forEach(user => {
          const userDiv = document.createElement('div');
          userDiv.className = 'user-item';
          userDiv.innerHTML = `
            <p><strong>Username:</strong> ${user.Username}</p>
            <p><strong>Login:</strong> ${user.Login}</p>
            <p><strong>Email:</strong> ${user.WorkingEmail}</p>
            <p><strong>Role ID:</strong> ${user.RolesID}</p>
          `;
          userList.appendChild(userDiv);
        });
      }
    } catch (error) {
      console.error('Error fetching users:', error);
    }
  }

  document.addEventListener("DOMContentLoaded", function() {
    fetchUsers();
  });
</script>

</body>
</html>

